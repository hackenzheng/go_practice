## 调度
调度有资源调度和任务调度,任务调度往往依赖资源调度. 任务有在线和离线之分,在线任务是指常驻的任务,比如HTTP服务,离线是批量计算的,比如定时任务,或者hive计算等.
k8s的优势是在线任务调度,而mesos和yarn是离线任务调度, 但borg是将在线和离线统一起来的, 在线和离线的混部能够提供集群利用率,因为在线和离线服务的潮汐变化正好相反,能够互补.
Mesos 是支持多种调度器的，Docker 容器型的任务，Hadoop、Spark 的计算任务等都可以运行在 Mesos 框架上，Mesos 强调的是资源混用的能力,k8s只专注于docker容器任务.  

在线和离线混部的难度就是资源调度,因为在线是常驻的,资源需求是跟外界请求有关,如果资源共享可能会影响业务,一旦共享如果在线任务资源不够,但另外一个任务没来得及释放就使得在需要时得不到
资源保证,如果允许抢占,那么离线任务该阶段的计算需要重新计算.

borg针对task任务进行资源分配；mesos针对不同的计算框架进行资源分配；yarn针对具体的job进行资源分配. mesos是二层调度,先把资源调度给framework(需要用户自定义比如Marathon框架),然后再给framework分配资源.

单个集群会有规模限制,所以一个机房会拆分为多个集群,k8s有跨集群的功能,支持管理多个集群.

k8s及yarn等资源调度时配置的quota的生效机制是: 在资源空闲时允许超额使用,上限不做限制,在资源不够时需要按quota的比例来使用.
k8s的升级有先杀后起和先起后杀两种模式,先起后杀需要资源比原来分配的多,先杀后起有可能导致断流,比如只有1个实例的时候.需要保证版本之间是兼容的,
这样才能做平滑升级.

基于yarn也可以开发自己的框架,比如机器学习框架.不管是MR,Spark,还是Flink，它们都是按照YARN对作业的抽象规则进行了开发，
把跟YARN的组件进行交互的部分、和自己的引擎规则都进行了封装，让用户只需要写出自己的逻辑，就可以将作业跑在YARN上面。
YARN的作业必须要实现一套ApplicationMaster的机制，在适当的时候，需要分别跟RM和NM进行交互.也有些计算引擎是在已经成型之后，再使用yarn的抽象把自己封装一下，才让自己跑在YARN上面的比如mr.
YARN支持自定义资源类型，在调度层面，YARN对于GPU与其他资源处理逻辑一致.

dag任务调度开源的airflow比较好

有状态任务:实例不要飘逸,本地有某种形式的存储，进程重启时要保持，比如使用了ShareMemory, 或本地磁盘存储持久化数据. 
不存在绝对不能进行实例迁移的系统，作为分布式存储系统不能进行单实例的故障恢复是不可接受的。
有状态服务一般也是分布式系统,即有状态服务一般都是多Shard多Replica的,多Shard单Replica , 单shard多Replica视为多 Shard 多 Replica 部分退化的情况。,单实例系统控制不飘相对比较容易.
但非本地重启需要触发数据恢复流程，时间消耗、资源消耗相对本地重启都代价太高,因此非本地重启需要尽量避免.
有两类服务，看似有状态，但支持实例漂移，因此依然归为无状态服务：
1. 需要持久存储支持，但可以使用远程PersistentVolume，是可以漂移的。因此我们认为不属于有状态服务.
2. 需要分Shard 以减轻单实例负载，但重启时数据可丢，只要保持Instance的shardID即可.
K8S 原生提供了StatefulSet，提供了InstanceSharding 的语义，但运维能力的支持有些欠缺。


可以使用mesos做训练任务调度, 也可以Inference使用k8s，training资源调度使用yarn, 也可以都是用k8s. OpenStack作为虚拟机管理,还是在广泛使用的.

## 计算与存储
mapReduce（2TB数据以上推荐使用）, Spark（2TB以下推荐使用，更大也可以但是需要较多资源), spark能够执行所需内存大于集群总内存的任务.

consul,etcd,zk都可以用于分布式配置管理,分布式锁.根据各自特点,etcd作为配置管理(高可靠一致性存储),consul作为服务注册和发现,zk用于选主.

gpu推理一般用tensorrt,训练可能用mxnet,需要做一层转换w

开源图计算引擎Gemini

mysql单库最大存储空间2T左右,单表可以达到几十亿行.

计费类的也可以通过kafka消费实现,但要做到不重不丢, 即exactly once的语义,但是发送发是at least once的语义,比如发送失败超时等情况,消费端需要做幂等设计.
容灾机制可以是再设置一条数据流,避免kafka挂掉服务不可用.

hdfs是eb级的,单集群节点超5w,单集群规模就能达到EB,但是yarn单集群只能达到10-20k的规模.

分布式事务,对于一个操作,比如发一篇文章,如果底层用到了kv,mysql多种存储,为了保证数据一致性,就需要保证都写成功或者都写失败,需要使用2pc或3pc等方法,但是代价比较大.
对于latency要求不高的场景,可以使用异步的操作,并发写不同的数据库,只要其中一个失败了就认为失败,但是会发一条消息进行重试,重试要能实现幂等.

##hitsz相关
https://github.com/Bohan-hu/HITSZ-COMP2008-Course
https://github.com/Wh1isper/ProductSearch_Backend
https://github.com/HLT-HITSZ/HLT-HITSZ.github.io
https://github.com/forturnme/SystemTap-Monitoring-MySQL8.0


5g-陶小峰(北邮教授）

5g-吕廷杰(北邮教授):5g的特点是低延时,高密度连接,大带宽,更多的是面向产业和工业互联网,实现万物互联,当然首先会是在娱乐消费领域应用.工业领域即数据采集,监控等,
传感器通过5g连接,形成物联网IOT. 比起光纤更方便,比起4g,wifi更稳定高效. 传感器一多更需要云计算,而无人驾驶场景等则更多的依赖边缘计算.
5g跟区块链也会互相促进,区块链就是分布式账本,物联网场景下的计费更复杂,区块链可以帮助解决.

risc-v 包云岗:物联网的芯片功能上更加碎片化(AI芯片也是碎片化之一), risc-v更适用, 而不是x86这种通用芯片. x86和arm指令集都是一千多条.
除了Intel,三星,ti三家公司是设计制造一体的,其他都是设计和制造分开, 设计又细分为IP核的设计和soc的设计,arm和高通是做IP设计, 而海思是做soc的,是将不同的IP集成.
芯片指令集,开发软件的开源降低做芯片的门槛.arm指令集是已经公开的,但如果要做一个支持arm指令集的芯片是会收到arm的律师函的.指令集是一个规范,而不是具体的实现.
arm指令集是可以授权的,也就是交钱是可以独自开发支持arm指令集的芯片, arm的IP核也是可以授权的.  而x86更封闭.x86卖芯片，arm卖授权，risc v走开源.
开源芯片生态四要素: 1,指令集,IP和soc(已经有risc-v); 2,开发语言和EDA工具链(已经有chisel,基于scala,开发效率大幅提升;开源的eda整个工具链已经有了,但待优化);
3,仿真验证(云模式的仿真验证,降低购买设备,服务器,软件成本); 4,操作系统和编译器.
serve.r平台,FPGA云平台, 在线做fpga实验,并非是模拟,提升学生兴趣, 目标能让学生做出自己的芯片. 国科大操作系统实验课程基础教学平台:基于RV64GC指令集的简易操作系统.
YouTube上搜索标签化体系结构.

开源芯片不只是risc-v,国外对开源芯片的研究更广泛更领先,

体系结构顶会ISCA. 
计算机教学领域旗舰会议SIGCSE

平头哥-谢源: 造芯片比喻成出书, 让天下没有难做的芯片.

人工智能-马毅<重新思考深度学习>:机器超过人了不起,超过人的想象才是了不起,比如开根号肯定超过人,但现在已经不神奇了.
要多动人脑而非电脑,从理论和本质上优化问题,提出优化方法,而非只是靠计算力基于大量的数据跑出一个结果. 网络不是越深越大越好,而是越浅越小越好.
成为某个领域的历史学家,知道问题的起源,现状,主要的节点,未来的发展.

risc-v解决物联网场景下的芯片,低功耗,需求碎片化;鸿蒙解决物联网场景的操作系统;5g解决物联网场景的连接;云计算解决物联网场景下的计算力;AI解决算法;

物体检测涉及到的领域问题有:分类/识别,物体检测,场景分割,实例分割(在场景分割的基础上对重叠的物体进行区分)
物体检测: 级联式(cascade)和单级式(single-shot),single-shot只是速度快,而且主要是训练时的速度,但是精度不高,并且在移动端或者inference场景,cascade并没有慢多少.
所以cascade是最好的,

## 工业界可以用到的点: 以项目出发复盘; 以接触到的列举;以学习的列举; 
消重,向量化召回,日志数据流etl,ad计费,图计算(pagerank,好友关系), 读放大写放大,大key

## 其他
京东买的乐仪（leyi）洗鼻器
氯雷他定和妮飘    鼻炎药
海马体照相馆，登记照片
头条内的头条保或微信搜索小程序“头号保”

很多人不知道，我们做的常规检查，查不出早期病变，一定要做专项检查才可以，这也是为什么很多人每年体检是正常的，但是查出癌症的一般就是中晚期的原因。
女性过了30岁，要做高危HPV检查和TCT检查；过了40岁还要做乳腺钼靶检查。
男性过了40岁，重点筛查胃肠癌和前列腺癌，做胃肠镜和PSA筛查；过了50岁，每年再做一次冠状动脉CT筛查，还有低剂量螺旋CT筛查肺癌。
最后提醒大家，投保前不要去体检，如果查出问题，很难投保成功。

预算充足的情况下 （一般年保费在3k以上）建议补充长期重疾；产品一般可选保障到80岁或终身，是一份长期的保障，产品即使停售合同仍有效；
一般长期重疾最高额度是50万，如果觉得保额不够高的话，可以选择加购一年期重疾抬高保额；如预算不那么充足，建议购买一年期重疾